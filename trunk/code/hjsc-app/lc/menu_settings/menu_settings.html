<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>菜单设置</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" href="../../css/mui.min.css" />
		<link rel="stylesheet" href="../../css/index.css" />
		<link rel="stylesheet" href="../../js/dragula.css" />
		<link rel="stylesheet" href="menu_settings.css" />
	</head>

	<body>

		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">菜单设置</h1>
		</header>

		<div class="top-title">

			<span>主菜单将根据下面排列显示</span>
			<span>拖动</span>
			<span>显示/隐藏</span>

		</div>
		<!-- 主页面内容容器 -->
		<!--<div id="home_scroll" class="mui-content mui-scroll-wrapper">
			<div class="mui-scroll" id="list">-->
		<ul id="add_app" class="mui-table-view">

			<li class="mui-table-view-cell mui-media" v-for="(item,index) in items" accesskey="index">
				<a href="javascript:;">
					<img class="mui-media-object mui-pull-left" :src="'../../'+item.imgurl">
					<label style="line-height: 54px;">{{item.name}}</label>

					<img class="three-one" src="../../icon/cdsz_drag.png" />

					<div class="mui-switch mui-switch-mini mui-switch-blue" id="zt">
						<div class="mui-switch-handle"></div>
					</div>

				</a>
			</li>

		</ul>
		<!--</div>
		</div>-->
		<script src="../../js/mui.min.js"></script>
		<script type="text/javascript" src="../../js/vue2.5.js"></script>
		<script type="text/javascript" src="../../js/jquery-3.2.1.min.js"></script>
		<script type="text/javascript" src="../../js/dragula.js"></script>
		<script type="text/javascript">
			mui.init()

			//请求接口数据
			var itemsdata = [{
					imgurl: 'icon/gl1.png',
					name: '查询',
					zt: true
				},
				{
					imgurl: 'icon/gl2.png',
					name: '跟踪',
					zt: true
				},
				{
					imgurl: 'icon/gl3.png',
					name: '检查',
					zt: false
				},
				{
					imgurl: 'icon/gl4.png',
					name: '主题',
					zt: true
				},
				{
					imgurl: 'icon/gl5.png',
					name: '对话',
					zt: false
				},
				{
					imgurl: 'icon/gl6.png',
					name: '会议',
					zt: true
				},
				{
					imgurl: 'icon/gl7.png',
					name: '虚拟场景',
					zt: false
				},
				{
					imgurl: 'icon/gl8.png',
					name: '工程日历',
					zt: true
				},
			];

			var addapp = new Vue({
				el: '#add_app',
				data: function() {
					return {
						items: itemsdata,
					}
				},
			})

			//dragula([document.getElementById('add_app')]);

			dragula([document.getElementById('add_app')], {
				//removeOnSpill: true
				moves: function(el, container, handle) {

					if(handle.className == 'three-one') {
						//$('li').css('touch-action','none');
						//$('#add_app').scroll({indicators: false});
						/*mui('#home_scroll').scroll({
							scrollY: true
						});*/
//						var w = window.innerWidth ||
//							document.documentElement.clientWidth || document.body.clientWidth;
//						var h = window.innerHeight  || document.documentElement.clientHeight  || document.body.clientHeight;
//						$('body').height(h);
//						//$('#add_app').height(110);
//						$('body').css('overflow','hidden');
						//$('#add_app').css('overflow','hidden');

					}

					return handle.className === 'three-one';
				},

			});

			/*$('#add_app').on('change', function() {
				alert();
			})*/

			$("#add_app").bind('DOMNodeInserted', function(e) {
				//alert('element now contains: ' + $(e.target).html());
				//$('#home_scroll').css('overflow','auto');
				//$('li').css('touch-action','auto');
			});

			//mui('#home_scroll').scroll();

			// 获取页面的高度、宽度
			function getPageSize() {
				var xScroll, yScroll;
				if(window.innerHeight && window.scrollMaxY) {
					xScroll = window.innerWidth + window.scrollMaxX;
					yScroll = window.innerHeight + window.scrollMaxY;
				} else {
					if(document.body.scrollHeight > document.body.offsetHeight) { // all but Explorer Mac    
						xScroll = document.body.scrollWidth;
						yScroll = document.body.scrollHeight;
					} else { // Explorer Mac...would also work in Explorer 6 Strict, Mozilla and Safari    
						xScroll = document.body.offsetWidth;
						yScroll = document.body.offsetHeight;
					}
				}
				var windowWidth, windowHeight;
				if(self.innerHeight) { // all except Explorer    
					if(document.documentElement.clientWidth) {
						windowWidth = document.documentElement.clientWidth;
					} else {
						windowWidth = self.innerWidth;
					}
					windowHeight = self.innerHeight;
				} else {
					if(document.documentElement && document.documentElement.clientHeight) { // Explorer 6 Strict Mode    
						windowWidth = document.documentElement.clientWidth;
						windowHeight = document.documentElement.clientHeight;
					} else {
						if(document.body) { // other Explorers    
							windowWidth = document.body.clientWidth;
							windowHeight = document.body.clientHeight;
						}
					}
				}
				// for small pages with total height less then height of the viewport    
				if(yScroll < windowHeight) {
					pageHeight = windowHeight;
				} else {
					pageHeight = yScroll;
				}
				// for small pages with total width less then width of the viewport    
				if(xScroll < windowWidth) {
					pageWidth = xScroll;
				} else {
					pageWidth = windowWidth;
				}
				arrayPageSize = new Array(pageWidth, pageHeight, windowWidth, windowHeight);
				return arrayPageSize;
			}
		</script>

	</body>

</html>